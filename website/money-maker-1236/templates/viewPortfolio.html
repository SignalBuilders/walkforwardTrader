<!DOCTYPE html>
{% include "header.html" %}
<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript">
      var allocationValues = JSON.parse('{{ portfolio }}');
      google.charts.load('current', {'packages':['line']});



      google.charts.setOnLoadCallback(prepareData);

    function prepareData() {
      data = new google.visualization.DataTable();
      data.addColumn('date', 'Day');
      console.log('{{ columns }}');
      var columns = JSON.parse('{{ columns | safe}}');
      console.log(columns);
      for (var i = 0; i < columns.length; i++) {
            console.log(columns[i]);
            data.addColumn('number', columns[i]);
        }
      
      var cleanedArr = [];
      for (var i = 0; i < allocationValues.length; i++) {
            var thisArr = allocationValues[i];
            thisArr[0] = new Date(thisArr[0]);
            cleanedArr.push(thisArr);
        }
      console.log(cleanedArr);


      data.addRows(cleanedArr);

      options = {
        chart: {
          title: 'Daily Returns',
          subtitle: 'in percent (%)'
        },
        hAxis: {
            format: 'M/d/y',
            
        },
        vAxis: {
            format: '#####.###%'
        },

      };
      drawChart();

    }

    function drawChart() {

      
      var chart = new google.charts.Line(document.getElementById('linechart_material'));

      chart.draw(data, google.charts.Line.convertOptions(options));
    }

    $(window).resize(function(){
      drawChart();
    });
    </script>
  </head>
  <body>
    <div id="linechart_material" style="width: 100%; min-height: 500px"></div>
  </body>
</html>